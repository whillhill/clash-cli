# clash-cli - Linux 一键安装 Clash 代理工具

![GitHub License](https://img.shields.io/github/license/whillhill/clash-cli)
![GitHub top language](https://img.shields.io/github/languages/top/whillhill/clash-cli)
![GitHub Repo stars](https://img.shields.io/github/stars/whillhill/clash-cli)
![PyPI](https://img.shields.io/pypi/v/clash-cli)
![Python](https://img.shields.io/pypi/pyversions/clash-cli)

一个简单易用的 Linux Clash 代理工具，支持一键安装、配置和管理。

**🎉 现已支持两种安装方式：Shell 脚本和 Python 包！**

## ✨ 特性

- 🚀 **一键安装**：自动下载并配置 Clash 内核
- 🔧 **智能管理**：统一的 `clash-cli` 命令行界面
- 🌐 **订阅转换**：内置 subconverter 本地订阅转换
- 🎯 **多内核支持**：默认 mihomo，可选 clash 内核
- 🐚 **多 Shell 支持**：兼容 bash、zsh、fish
- 🔒 **系统集成**：systemd 服务管理，开机自启
- 🌍 **Web 控制台**：可视化节点管理和监控
- 📱 **Tun 模式**：全局代理，支持 Docker 容器
- 🐍 **Python 支持**：现代化的 pip 安装方式

## 📋 环境要求

- **操作系统**：CentOS 7+、Debian 10+、Ubuntu 18.04+
- **用户权限**：`root` 或 `sudo` 权限
- **Shell 环境**：`bash`、`zsh`、`fish` 任一
- **系统服务**：`systemd` 支持

## 🚀 安装方式

### 方式一：Python 包安装（推荐）

```bash
# 安装
pip install clash-cli

# 使用
sudo clash-cli install
clash-cli on
clash-cli status
```

### 方式二：Shell 脚本安装（传统方式）

#### 直接安装

```bash
git clone --branch main --depth 1 https://github.com/whillhill/clash-cli.git \
  && cd clash-cli \
  && sudo bash install.sh
```

#### 使用加速镜像

```bash
git clone --branch main --depth 1 https://gh-proxy.com/https://github.com/whillhill/clash-cli.git \
  && cd clash-cli \
  && sudo bash install.sh
```

#### 安装过程说明

1. **下载项目**：克隆仓库到本地
2. **输入订阅**：安装时输入您的 Clash 订阅链接
3. **自动配置**：脚本自动下载内核、配置服务
4. **启动服务**：安装完成后自动启动代理服务

> 💡 **提示**：两种安装方式使用相同的 Clash 内核和配置，命令完全一致

## 📖 使用教程

### Python 包使用

安装 Python 包后，可以使用以下命令：

```bash
# 安装 Clash（需要 sudo 权限）
sudo clash-cli install

# 指定订阅链接安装
sudo clash-cli install -s "https://your-subscription-url.com"

# 使用 clash 内核（默认是 mihomo）
sudo clash-cli install --kernel clash

# 基本操作
clash-cli on          # 开启代理
clash-cli off         # 关闭代理
clash-cli status      # 查看状态
clash-cli ui          # 查看 Web 控制台地址
```

### Shell 脚本使用

安装完成后，使用 `clash-cli` 命令管理代理服务：

```bash
$ clash-cli
Usage:
    clash-cli COMMAND [OPTION]

Commands:
    on                   ????
    off                  ????
    ui                   ????
    status               ????
    proxy    [on|off]    ????
    tun      [on|off]    Tun ??
    mixin    [-e|-r]     Mixin ??
    secret   [SECRET]    Web ??
    update   [auto|log]  ????
```

### ?? ????

#### ???????

```bash
# ??????
$ clash-cli on
?? ???????

# ??????
$ clash-cli off
?? ???????

# ??????
$ clash-cli status
? mihomo.service - mihomo Daemon, A[nother] Clash Kernel.
   Loaded: loaded (/etc/systemd/system/mihomo.service; enabled; vendor preset: enabled)
   Active: active (running) since Mon 2025-01-27 10:30:15 CST; 2h 15min ago
```

**??**?
- `clash-cli on` ????????????????????
- `clash-cli off` ??????????????
- ????????????????????

#### ??????

```bash
# ???????????????
$ clash-cli proxy on
?? ???????

# ?????????????
$ clash-cli proxy off
?? ???????

# ??????
$ clash-cli proxy status
?? ???????
http_proxy? http://127.0.0.1:7890
socks_proxy?socks5h://127.0.0.1:7890
```

### ?? Web ???

#### ?????

```bash
$ clash-cli ui
?????????????????????????????????????????????????
?                ?? Web ???                  ?
?????????????????????????????????????????????????
?                                               ?
?     ?? ???????9090                      ?
?     ?? ???http://192.168.0.1:9090/ui       ?
?     ?? ???http://255.255.255.255:9090/ui   ?
?     ?? ???http://board.zash.run.place      ?
?                                               ?
?????????????????????????????????????????????????
```

#### ????

```bash
# ??????
$ clash-cli secret mypassword123
?? ????????????

# ??????
$ clash-cli secret
?? ?????mypassword123

# ?????????
$ clash-cli secret ""
?? ????????????
```

#### Web ?????

- **????**??????????????
- **????**??????????
- **????**???????????
- **????**??????????
- **????**?????????

**????**?
- ??????????????
- ???????????????????
- ??? `allow-lan: false` ???????

### ?? ????

#### ??????

```bash
# ??????????
$ clash-cli update https://your-subscription-url.com
?? ???????????...
?? ???????????...
?? ??????

# ???????????
$ clash-cli update
?? ??????

# ??????
$ clash-cli update log
? [2025-01-27 10:30:15] ???????https://your-subscription-url.com
? [2025-01-27 08:15:22] ???????https://your-subscription-url.com
```

#### ??????

```bash
# ????????2??????
$ clash-cli update auto
?? ?????????

# ???????????????
$ clash-cli update auto https://new-subscription-url.com
?? ?????????

# ??????
$ crontab -l | grep clash-cli
0 0 */2 * * /bin/bash -i -c 'clash-cli update https://your-subscription-url.com'
```

#### ??????

- **????**??? subconverter???????????
- **????**?????????????????
- **????**??? V2Ray?Trojan?SS?SSR ?????
- **????**???????????????????

### ?? Tun ??

#### ?? Tun ??

```bash
# ?? Tun ??
$ clash-cli tun
?? Tun ?????

# ?? Tun ??
$ clash-cli tun on
?? Tun ?????

# ?? Tun ??
$ clash-cli tun off
?? Tun ?????
```

#### Tun ????

**????**?
- **????**???????????
- **????**??? Docker?Podman ???????
- **DNS ??**????? DNS ????? DNS ??
- **????**???????????????

**????**?
- ?????????????
- Docker ???????
- ?????????????????

**????**?
- ?? root ???????
- ???????????
- ?????????????

### ?? ????

#### Mixin ????

```bash
# ?? mixin ??
$ clash-cli mixin
?? less ?? mixin ??

# ?? mixin ??
$ clash-cli mixin -e
?? vim ?? mixin ??

# ?????????????????
$ clash-cli mixin -r
?? less ?? ??? ??
```

#### Mixin ????

**????**?
- **?????**???????? Mixin ???????????
- **????**?????? = ???? + Mixin ??
- **???**?Mixin ?? > ????

**??????**?

```yaml
# ??????
system-proxy:
  enable: true

# Web ???
external-controller: "0.0.0.0:9090"
external-ui: public
secret: "your-password"

# ???????
allow-lan: true
authentication:
  - "username:password"

# ??? DNS
dns:
  enable: true
  listen: 0.0.0.0:1053
  enhanced-mode: fake-ip
  nameserver:
    - 114.114.114.114
    - 8.8.8.8

# ?????
rules:
  - DOMAIN-SUFFIX,example.com,DIRECT
  - DOMAIN-KEYWORD,google,PROXY
```

## ?? ????

### ????

#### ??????
```bash
# ????????
$ clash-cli status -l
$ journalctl -u mihomo -f

# ??????
$ clash-cli mixin -r
```

#### ??????
```bash
# ??????
$ netstat -tlnp | grep :7890
$ netstat -tlnp | grep :9090

# ????
$ clash-cli off && clash-cli on
```

#### ??????
```bash
# ??????
$ clash-cli update log

# ????????
$ curl -I "your-subscription-url"
```

### ????

```bash
# ??????
$ journalctl -u mihomo -f

# ??????
$ clash-cli update log

# ??????
$ tail -f /var/log/syslog | grep clash
```

## ??? ??

???? clash-cli?

```bash
# ?????????
$ sudo bash uninstall.sh

# ??????????
$ sudo systemctl stop mihomo
$ sudo systemctl disable mihomo
$ sudo rm -rf /opt/clash
$ sudo rm -f /etc/systemd/system/mihomo.service
```

## ?? ??

???? Issue ? Pull Request ????????

### ????

1. Fork ???
2. ?????? (`git checkout -b feature/AmazingFeature`)
3. ???? (`git commit -m 'Add some AmazingFeature'`)
4. ????? (`git push origin feature/AmazingFeature`)
5. ?? Pull Request

## ?? ???

????? MIT ??? - ?? [LICENSE](LICENSE) ???????

## ?? ??

?????????

- [mihomo](https://github.com/MetaCubeX/mihomo) - ???? Clash ??
- [subconverter](https://github.com/tindy2013/subconverter) - ??????
- [yacd](https://github.com/haishanh/yacd) - Web ?????
- [yq](https://github.com/mikefarah/yq) - YAML ????

## ? Star History

<a href="https://www.star-history.com/#whillhill/clash-cli&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=whillhill/clash-cli&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=whillhill/clash-cli&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=whillhill/clash-cli&type=Date" />
 </picture>
</a>

## ?? ????

1. ?????????? Shell ????
2. ??????????????????
3. ?????????????????????
4. ????????????????????

---

<div align="center">

**??????????????? ? Star ?????**

Made with ?? by [whillhill](https://github.com/whillhill)

</div>
